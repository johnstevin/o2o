<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <title>{:C('WEB_SITE_TITLE')}|管理平台</title>

    <link rel="stylesheet" type="text/css" href="__STATIC__/bootstrap/css/bootstrap.min.css" media="all">
    <link rel="stylesheet" type="text/css" href="__CSS__/site.css" media="all">
    <link rel="stylesheet" type="text/css" href="__STATIC__/jquery-ui/jquery-ui.min.css" media="all">

    <script type="text/javascript" src="__STATIC__/js/jquery.min.js"></script>

    <script type="text/javascript" src="__STATIC__/bootstrap/js/bootstrap.min.js" ></script>
    <script type="text/javascript" src="__STATIC__/jquery-ui/jquery-ui.min.js" ></script>
    <script type="text/javascript" src="__JS__/base.js" ></script>

    <script>
        //cookies前缀
        var cookiesPrefix = "d19550f3-1ace-4529-83d5-8844cd26535d";
        var rootPath = 'http://www.o2o.com/';
    </script>

</head>

<body>
<header>
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#" onclick="showSubMenu(0, false)">社区O2O</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav" id="nav-root-ul">
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">你好，<em title="{:session('admin_auth.mobile')}">{:session('admin_auth.mobile')}</em><span class="caret"></span></a>
                        <ul class="dropdown-menu" role="menu">
                            <!--<li class="manager">你好，<em title="{:session('user_auth.username')}">{:session('user_auth.username')}</em></li>-->
                            <li><a href="{:U('User/updatePassword')}">修改密码</a></li>
                            <li><a href="{:U('User/updateNickname')}">修改昵称</a></li>
                            <li><a href="{:U('Public/logout')}">退出</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>
</header>

<div class="container" id="rg-container-main">
    <div class="row">
        <div id="rg-col-nav-sub" class="rg-hidden">
            <ol class="breadcrumb rg-header-title">
                <li class="active" id="rg-title-nav-sub"></li>
            </ol>
            <div class="list-group rg-header-title" id="rg-menu-nav-sub"></div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12" id="rg-col-main">
            <ol class="breadcrumb rg-header-title" id="rg-position">
                <li></li>
            </ol>
            <div border="false" id="rg-container-fun">

            </div>
        </div>
    </div>
</div>

<footer id="rg-footer">
    <p>&copy; 北京云图科技有限公司成都分公司</p>
</footer>

<div class="modal fade bs-example-modal-lg" id="DlgModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content"><div class="rg-loading"></div>
        </div>
    </div>
</div>


</body>
</html>
<script>
var menuJson = "",
    rootMenuIndex = -1/*显示的菜单*/,
    subMenuIndex = -1/*运行的功能*/,
    haveSubMenu = 0,
    cssEasing = "easeOutBounce",//
    cssDelay = 500;

$(document).ready(function () {
    changeMainPanelHeight(true);
    // 加载导航
    result='{$menu_list}';
    var navStr = "";
    menuJson = $.parseJSON(result);
    //首页每个人都有，所以不需要权限判断，直接在这里加上
    var indexObj =
    {
        'id': "00",
        "fid": null,
        "text": "主页",
        "iconCls": "",
        "url": "/AppHome/Entrance",
        //"url": "Entrance",
        "children": ""
    };
    menuJson.unshift(indexObj);
    //生成nav菜单
    var i = 0;
    for (i = 1; i < menuJson.length; i++) {
        navStr += '<li id="nav-root-li-' + i + '"><a href=\"#\" onclick="showSubMenu(' + i + ',false)">' + menuJson[i].text + '</a></li>';
    }
    $('#nav-root-ul').html(navStr);

    //恢复或初始化subnav
    if (getCookie(cookiesPrefix + "rootMenuId") != null) {
        //有cookies记录显示的列表
        for (i = 0; i < menuJson.length; i++) {
            if (menuJson[i].id == getCookie(cookiesPrefix + "rootMenuId")) {
                break;
            }
        }
        if (i < menuJson.length) {
            //记录的cookies有匹配的
            showSubMenu(i, true);
        }
        else {
            //记录的cookies没有匹配的
            showSubMenu(0, true);
        }
    } else {
        //显示列表初始化
        showSubMenu(0, true);
    }

    //恢复或初始化功能
    if (menuJson[rootMenuIndex].children != null && menuJson[rootMenuIndex].children != "") {
        //当前显示的功能有下级功能。
        if (getCookie(cookiesPrefix + "subMenuId") != null) {
            //有cookies记录当前功能
            for (var i = 0; i < menuJson[rootMenuIndex].children.length; i++) {
                if (menuJson[rootMenuIndex].children[i].id == getCookie(cookiesPrefix + "subMenuId")) {
                    break;
                }
            }
            if (i < menuJson[rootMenuIndex].children.length) {
                //记录的cookies有匹配的
                showFun(rootMenuIndex, i);
            }
            else {
                //记录的cookies没有匹配的
                //打开默认功能
                showFun(rootMenuIndex, -1);
            }
        }
        else {
            //没有cookies记录
            //打开默认功能
            showFun(rootMenuIndex, -1);
        }
    }
    else {
        //没有cookies记录
        //打开默认功能
        showFun(rootMenuIndex, -1);
    }
});
</script>