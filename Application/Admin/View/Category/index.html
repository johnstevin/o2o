<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="__STATIC__/bootstrap/css/bootstrap.min.css"/>
    <script type="text/javascript" src="../../../Public/static/js/jquery.min.js"></script>
</head>
<body>
<div class="container">
    <div>
        <h2>分类管理</h2>
    </div>
    <div>
        <a id="add-group" class="btn btn-success" href="{:U('add')}">新 增</a>
    </div>
    <table class="table table-hover">
        <tr id="table-header">
            <th width="65">折叠</th>
            <th width="100">ID</th>
            <th width="100">排序</th>
            <th>标题</th>
            <th width="100">PID</th>
            <th>状态</th>
            <th>增加子类</th>
            <th width="200">操&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作</th>
            <th>关联品牌</th>
        </tr>
    </table>
</div>
</body>
</html>
<script>
    var arrTree = jQuery.parseJSON('{$tree|json_encode}');
    $(document).ready(function () {
        var string = '';

        function digui(list, level) {
            var level = level ? level : 0,prefix = '';
            for(i=0;i<level;i++){
                if(i==0 && level == 1){
                    prefix += '└——';
                }else if(i==0 && level > 1){
                    prefix += '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|';
                }else {
                    prefix += '——';
                }
            }
            $.each(list, function (k, v) {
                string += '<tr>' +
                '<td> + </td><td>' + v.id + '</td>' +
                '<td>' + v.sort + '</td>' +
                '<td>' + prefix+v.title + '</td>' +
                '<td>' + v.pid + '</td>' +'<td>' + v.status + '</td>'+
                '<td><a class="btn btn-xs btn-primary" href="{:U("add")}&pid='+ v.id+'">增加子类</a> </td>'+
                '<td>'+'<a class="btn btn-xs btn-warning" href="{:U("edit")}&id='+ v.id+'&pid='+ v.pid+'">编辑</a>'+
                '<a class="btn btn-xs btn-danger" href="{:U("Category/changeStatus")}&method=resumecategory&id='+ v.id+'">启用</a>'+
                '<a class="btn btn-xs btn-danger" href="{:U("Category/changeStatus")}&method=forbidcategory&id='+ v.id+'">禁用</a>'+
                '<a class="btn btn-xs btn-danger" href="{:U("Category/changeStatus")}&method=deletecategory&id='+ v.id+'">删除</a>'+'</td>' +
                '<td><a class="btn btn-xs btn-primary" href="{:U("Category/brand_index")}&id='+ v.id+'">关联品牌</a> </td>'+
                '</tr>'
                if (v._child) {
                    digui(v._child, level + 1);
                }
            })
        }
        digui(arrTree);
        $('#table-header').after(string)
    });
</script>

