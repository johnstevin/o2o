<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>{$meta_title}</title>
    <link rel="stylesheet" href="__STATIC__/bootstrap/css/bootstrap.min.css"/>
    <script type="text/javascript" src="__STATIC__/js/jquery.min.js"></script>
    <script>
        var arrTree = jQuery.parseJSON('{$_list|json_encode}');
        $(document).ready(function(){

            function recursionJSON(data,str) {
                str += "　";
                if(typeof(data) == "object") {
                    $.each(data, function(i, n){
                        $("#tree").append('<li>'+str+'<input type="checkbox" value="'+ n.id+'" name="rule[]" />'+n.title+'</li>');
                        if(typeof(n.child) == "object") {
                            recursionJSON(n.child,str+"　");
                        }
                    });
                }
            }

            recursionJSON(arrTree,"");

        });

    </script>
</head>
<body>
<div class="container-fluid">
    <!-- 标题栏 -->
    <div>
        <h2>权限节点管理</h2>
    </div>
    <!-- 操作  -->
    <div>
        <a id="add-group" class="btn btn-success" href="{:U('add')}">新 增</a>
        <!--<a id="edit-group" class="btn btn-info" href="{:U('edit')}">编 辑</a>-->
        <!--<a id="remove-group" class="btn btn-warning" href="{:U('remove')}">删 除</a>-->
    </div>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <!--<th class="row-selected row-selected"><input class="check-all" type="checkbox"/></th>-->
            <th>标题</th>
            <th>添加子分类</th>
            <th>描述</th>
            <th>资源</th>
            <th>层级</th>
            <th>状态</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
<!--<div id="tree"></div>-->
        <notempty name="_list">
            <!--&lt;!&ndash;递归显示数据&ndash;&gt;-->
            <!--<foreach name="list" item="item" >-->
            <!--</foreach>-->

            <volist name="_list" id="vo">
                <tr>
                    <!--<td><input class="ids" type="checkbox" name="id[]" value="{$vo.id}"/></td>-->
                    <td><a href="{:U('edit?id='.$vo['id'].'&pid='.$vo['pid'])}">{$vo.title}</a></td>
                    <td><a href="{:U('add?pid='.$vo['id'])}">添加子分类</a></td>
                    <td><span>{:mb_strimwidth($vo['description'],0,60,"...","utf-8")}</span></td>
                    <td>{$vo.url}</td>
                    <td>{$vo.level}</td>
                    <td>{$vo.status_text}</td>
                    <td>
                        <eq name="vo.status" value="1">
                            <a href="{:U('AuthRule/changeStatus?method=forbidRule&id='.$vo['id'])}"
                               class="ajax-get">禁用</a>
                            <else/>
                            <a href="{:U('AuthRule/changeStatus?method=resumeRule&id='.$vo['id'])}"
                               class="ajax-get">启用</a>
                        </eq>
                        <a href="{:U('AuthRule/changeStatus?method=deleteRule&id='.$vo['id'])}"
                           class="confirm ajax-get">删除</a>
                    </td>
                </tr>
            </volist>
            <else/>
            <td colspan="6" class="text-center"> aOh! 暂时还没有内容!</td>
        </notempty>

        </tbody>
    </table>
    <div class="page">
        <nav>
            <ul class="pagination">
                {$_page}
            </ul>
        </nav>
    </div>
</div>
</body>
</html>