<div class="row">
    <div class=" col-sm-6 col-lg-4">
        <a class=" btn btn-success ajax-loading" id="add-category"\
           href="{:U('add')}">提交工单</a>
    </div>
    <!-- 高级搜索 -->
    <div class="search-form fr cf  col-sm-6 col-lg-8">
        <div class="input-group">
            <input type="text" id="searchInput" name="name" class="form-control search-input" value="{:I('name')}"
                   placeholder="请输入工单编号或名称">
                    <span class="input-group-btn">
                        <button class="btn btn-default sch-btn" class="sch-btn" href="javascript:void(0);" id="search"
                                type="button" url="{:U('Feedback/index')}">搜索
                        </button>
                    </span>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-12">
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                <tr>
                    <th class="row-selected row-selected"><input class="check-all" type="checkbox"/></th>
                    <th>工单编号</th>
                    <th>问题标题</th>
                    <th>问题分类</th>
                    <th>提交时间</th>
                    <th>状态</th>
                    <th>详细</th>
                    <th>编辑</th>
                    <th>删除</th>
                </tr>
                </thead>
                <tbody>
                <notempty name="_list">
                    <volist name="_list" id="vo">
                        <tr>
                            <td><input class="ids" type="checkbox" name="id[]" value="{$vo.id}"/></td>
                            <td>{$vo.id}</td>
                            <td><a class="ajax-loading"
                                   href="{:U('detail?id='.$vo['id'])}">{$vo.title}</a></td>
                            <td>{$vo.cate_id|get_feedback_type}</td>
                            <td>{$vo.create_time|time_format}</td>
                            <td>{$vo.status_text}</td>
                            <td>
                                <a class="ajax-loading" href="{:U('detail?id='.$vo['id'])}">详细</a>
                            </td>
                            <td>
                                <a class="ajax-loading"
                                   href="{:U('edit?id='.$vo['id'])}">编辑</a>
                            </td>
                            <td>

                                <a href="{:U('Feedback/changeStatus?method=delete&id='.$vo['id'])}"
                                   class="confirm ajax-get">删除</a>
                            </td>

                        </tr>
                    </volist>
                    <else/>
                    <td colspan="8" class="text-center"> aOh! 暂时还没有内容!</td>
                </notempty>
                </tbody>
            </table>
        </div>
        <div class="page">
            {$_page}
        </div>
    </div>
</div>

<script>
    //搜索功能
    $("#search").click(function () {
        var url = $(this).attr('url');
        var query = $('.search-form').find('input').serialize();
        query = query.replace(/(&|^)(\w*?\d*?\-*?_*?)*?=?((?=&)|(?=$))/g, '');
        query = query.replace(/^&/g, '');
        if (url.indexOf('?') > 0) {
            url += '&' + query;
        } else {
            url += '?' + query;
        }
        var target = url;
        // var target = $('#rg-container-fun').attr("href") + "?name=" + $('#searchInput').val();
        if (target) {
            contentload(target);
        }
        //window.location.href = url;
    });
    //回车搜索
    $(".search-input").keyup(function (e) {
        if (e.keyCode === 13) {
            $("#search").click();
            return false;
        }
    });
    baseJs();
    //ajax loading请求
    $('.ajax-loading').click(function () {
        var target;
        if ((target = $(this).attr('href')) || (target = $(this).attr('url'))) {
            contentload(target);
        }

        return false;
    });

</script>