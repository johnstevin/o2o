<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>社区O2O平台</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" href="__STATIC__/bootstrap/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <h3>用户注册</h3>
    <hr>
    <div class="row">
        <div class="col-md-6">
            <div id="msg"></div>
            <form action="?" method="post" name="form" class="form">
                <div class="form-group">
                    <div>
                        <label>手机号</label>
                    </div>
                    <div class="row">
                        <div class="col-xs-7 col-sm-8 col-md-8">
                            <input type="text" class="form-control  input-lg" id="mobile" name="mobile"
                                   placeholder="手机号码">
                        </div>
                        <div class="col-xs-5 col-sm-4 col-md-4">
                            <button type="button" id="VerifyMessage" class="btn btn-default btn-lg btn-block" onclick="getVerifyCode()">
                                获取验证码
                            </button>
                        </div>
                    </div>

                </div>

                <div class="form-group">
                    <label for="verify_code">短信验证码</label>
                    <input type="text" class="form-control  input-lg" id="verify_code" name="verify_code"
                           placeholder="短信验证码">
                </div>
                <!--<div class="form-group">-->
                <!--<label for="username">用户名</label>-->
                <!--<input type="text" class="form-control input-lg" id="username" name="username" placeholder="用户名">-->
                <!--</div>-->
                <div class="form-group">
                    <label for="password">密码</label>
                    <input type="password" class="form-control  input-lg" id="password" name="password"
                           placeholder="6-16为数字、英文字母大小写">
                </div>
                <div class="form-group">
                    <label for="password">确认密码</label>
                    <input type="password" class="form-control  input-lg" id="repassword" name="repassword"
                           placeholder="确认密码">
                </div>
                <!--<div class="form-group">-->
                <!--<label for="email">邮箱</label>-->
                <!--<input type="text" class="form-control  input-lg" id="email" name="email" placeholder="邮箱">-->
                <!--</div>-->


                <div class="checkbox">
                    <label style="height: 40px;padding-top: 10px;">
                        <input id="AgreementInput" type="checkbox" checked> 我已阅读并接受
                        <a data-backdrop="false" data-toggle="modal" data-target="#AgreementModal"> 服务与隐私协议</a>
                    </label>
                </div>

                <button type="button" id="reg" class="btn btn-info btn-lg btn-block" onclick="register()">注册</button>
            </form>


        </div>
        <div class="col-md-offset-1 col-md-5">
            已经有账号？<br>
            <a type="button" href="{:U('Public/login')}" class="btn btn-default">立即登录</a>
        </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="__STATIC__/js/jquery.min.js"></script>
    <script src="__STATIC__/js/jquery.md5.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="__STATIC__/bootstrap/js/bootstrap.min.js"></script>
</div>

<!--条款协议-->
<div class="modal fade bs-example-modal-lg" id="AgreementModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">服务与隐私协议</h4>
            </div>
            <div class="modal-body">
                <p>
                    欢迎您使用一点社区帐号平台（下面简称平台），为确保用户的合法权益及正常商业秩序（“用户”是指使用平台相关服务的使用人，在本协议中更多地称为
                    “您”。），特制订一点社区帐号平台服务协议（下面简称本协议），本协议由您与平台的经营者共同缔结，本协议具有合同效力。<span></span>
                    &nbsp;
                </p>
                <h4>
                    一、协议内容及签署<span></span>
                    &nbsp;
                </h4>

                <p>
                    1.1.本协议内容包括协议正文及所有平台已经发布的或将来可能发布的各类规则。所有规则为本协议不可分割的组成部分，与协议正文具有同等法律效力。除另行明确声明外，任何平台及其关联公司提供的服务（以下称为平台服务）均受本协议约束。<span></span>
                    &nbsp;
                </p>

                <p>
                    1.2.您应当在使用平台服务之前认真阅读全部协议内容，对于协议中以加粗字体显示的内容，您应重点阅读。如您对协议有任何疑问的，应向平台咨询。但无论
                    您事实上是否在使用平台服务之前认真阅读了本协议内容，只要您使用平台服务，则本协议即对您产生约束，届时您不应以未阅读本协议的内容或者未获得平台对您
                    问询的解答等理由，主张本协议无效，或要求撤销本协议。<span></span>
                    &nbsp;
                </p>

                <p>
                    1.3.您承诺接受并遵守本协议的约定。如果您不同意本协议的约定，您应立即停止注册<span>/</span>激活程序或停止使用平台服务。<span></span>
                    &nbsp;
                </p>

                <p>
                    1.4.平台有权根据需要不时地制订、修改本协议及<span>/</span>或各类规则，并以网站公示的方式进行公告，不再单独通知您。变更后的协议和规则一经在网站公布后，立即自动生效。如您不同意相关变更，应当立即停止使用平台服务。您继续使用平台服务的，即表示您接受经修订的协议和规则。<span></span>
                    &nbsp;
                </p>
                <h4>
                    二、协议范围<span></span>
                    &nbsp;
                </h4>

                <p>
                    2.1.本协议是您与平台之间关于用户使用平台相关服务所订立的协议。“平台”是指平台及其相关服务可能存在的运营关联单位。<span></span>
                    &nbsp;
                </p>

                <p>
                    2.2.本协议项下的服务是指平台向用户提供的包括但不限于通讯功能、支付功能、存储功能和广告等产品及服务（以下简称“本服务”）。<span></span>
                    &nbsp;
                </p>

                <p>
                    2.3.本协议内容同时包括补充协议，且您在使用平台某一特定服务时，该服务可能会另有单独的协议、相关业务规则等（以下统称为“单独协议”）。上述内容
                    一经正式发布，即为本协议不可分割的组成部分，您同样应当遵守。您对前述任何业务规则、单独协议的接受，即视为您对本协议全部的接受。<span></span>
                    &nbsp;
                </p>
                <h4>
                    三、注册与帐号<span></span>
                    &nbsp;
                </h4>

                <p>
                    3.1.注册者资格<span></span>
                    &nbsp;
                </p>

                <p>
                    您确认，在您完成注册程序或以其他平台允许的方式实际使用平台服务时，您应当是具备完全民事权利能力和完全民事行为能力的自然人、法人或其他组织。若您不
                    具备前述主体资格，则您及您的监护人应承担因此而导致的一切后果，且平台有权注销或永久冻结您的帐号，并保留向您及您的监护人索偿的权利。<span></span>
                    &nbsp;
                </p>

                <p>
                    3.2.注册帐号的渠道<span></span>
                    &nbsp;
                </p>

                <p>
                    一点社区基础产品用户默认自动开通平台，无需另行注册即可以使用平台各项互联网内容及应用服务以及平台合作的第三方互联网应用服务。您可以通过以下渠道进行帐号注册，包括但不限于：<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>1</span>）手机短信注册<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>2</span>）手机号注册<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>3</span>）邮箱号注册<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>4</span>）第三方帐号首次登录注册<span></span>
                    &nbsp;
                </p>

                <p>
                    3.3.您完成申请注册程序后，依照平台的业务规则获得使用权。<span></span>
                    &nbsp;
                </p>

                <p>
                    3.4.无论您通过何种方式注册平台，均受本规则约束。<span></span>
                    &nbsp;
                </p>

                <p>
                    3.5.用户信息<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>1</span>）在完成注册或激活流程时，若国家法律法规有特殊规定的，您需要填写真实的身份信息，请按相应页面的提示准确提供并及时更新您的资料，以使之真实、及时、完整和准确。如有合理理由怀疑您提供的资料错误、不实、过时或不完整的，平台有权向您发出询问及<span>/</span>或要求改正的通知，并有权直接做出删除相应资料的处理，直至中止、终止对您提供部分或全部平台服务。平台对此不承担任何责任，您将承担因此产生的任何直接或间接损失及不利后果。<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>2</span>）您应当准确填写并及时更新您提供的电子邮件地址、联系电话、联系地址、邮政编码等联系方式，以便平台与您进
                    行有效联系，因通过这些联系方式无法与您取得联系，导致您在使用平台服务过程中产生任何损失或增加费用的，应由您完全独自承担。您了解并同意，您有义务保
                    持你提供的联系方式的有效性，如有变更或需要更新的，您应按平台的要求进行操作。<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>3</span>）
                    平台与用户一同致力于个人信息的保护，保护用户个人信息是平台的一项基本原则。未经您的同意，平台不会向平台以外的任何公司、组织和个人披露您的个人信息，但法律法规另有规定的除外。<span></span>
                    &nbsp;
                </p>

                <p>
                    3.6.帐号安全<span></span>
                    &nbsp;
                </p>

                <p>
                    您须自行负责对您的平台帐号和密码保密，您需要采取特定措施保护您的号码安全，包括但不限于妥善保管平台帐号与密码、安装防病毒木马软件、定期更改密码等
                    措施。且须对您在该帐号和密码下发生的所有活动（包括但不限于信息披露、发布信息、网上点击同意或提交各类规则协议、网上续签协议或购买服务等）承担责
                    任。根据平台及<span>/</span>或合作第三方的要求，用户选择使用天平台帐号登录使用互联网（或移动互联网）应用服务时，可能需要与平台及<span>/</span>或合作第三方签订相关应用服务条款。无论是否签订相关条款，用户均应当自觉遵守平台及<span>/</span>或合作第三方<span>SP/CP</span>在应用服务中的特定要求及规定。平台不承担因用户使用<span>SP/CP</span>所提供应用服务而产生的一切义务和责任。<span></span>
                    &nbsp;
                </p>

                <p>
                    您同意：<span>(a) </span>如发现任何人未经授权使用您的帐号和密码，或发生违反保密规定的任何其他情况，您会立即通知平台；<span> (b) </span>确保您在每个上网时段结束时，以正确步骤离开网站<span>/</span>服务。平台不能也不会对因您未能遵守本款规定而发生的任何损失负责。您理解平台对您的请求采取行动需要合理时间，平台对在采取行动前已经产生的后果（包括但不限于您的任何损失）不承担任何责任。<span></span>
                    &nbsp;
                </p>

                <p>
                    3.7.密码找回<span></span>
                    &nbsp;
                </p>

                <p>
                    如果您的平台帐号被盗、密码遗忘或因其他原因导致无法正常登录，您可以按照平台的申诉途径进行申诉，平台并不承诺您一定能通过申诉找回帐号密码。<span></span>
                    &nbsp;
                </p>
                <h4>
                    四、用户行为规范<span></span>
                    &nbsp;
                </h4>

                <p>
                    4.1. 您不得恶意注册平台帐号。平台可以对恶意注册行为进行独立判断和处理。<span></span>
                    &nbsp;
                </p>

                <p>
                    4.2 .平台号码使用权仅属于初始申请注册人。未经平台许可，您不得赠与、借用、租用、转让或售卖平台号码或者以其他方式许可非初始申请注册人使用平台号码。<span></span>
                    &nbsp;
                </p>

                <p>
                    4.3.如果您当前使用的平台帐号并不是您初始申请注册的或者通过平台提供的其他途径获得的，您不得用该号码登录或进行任何操作，并请您在第一时间通知平台或者该号码的初始申请注册人。<span></span>
                    &nbsp;
                </p>
                <h4>
                    五、协议终止<span></span>
                    &nbsp;
                </h4>

                <p>
                    5.1.出现以下情况时，平台有权进行独立判断并随时限制、冻结或终止您对平台帐号的使用，并根据实际情况决定是否恢复使用，且无须为此向您或任何第三方承担任何责任：<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>1</span>）违反法律法规、平台各服务协议或业务规则的规定。<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>2</span>）平台发现您并非号码初始申请注册人，平台有权在未经通知的情况下终止您使用该号码。<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>3</span>）为了充分利用号码资源，如果您存在注册平台帐号后未及时进行初次登录使用，或长期未登录使用平台帐号等情形，平台有权终止该帐号的使用。<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>4</span>）
                    &nbsp; &nbsp; &nbsp;本协议（含规则）变更时，您明示并通知平台不愿接受新的服务协议的<span>.</span>
                    &nbsp;
                </p>

                <p>
                    （<span>5</span>）用户使用平台帐号服务的权利可以是个人的，也可以是一个公司或实体的商业性组织。未经平台同意，用户不能利用平台帐号相关服务进行销售或其他商业用途。<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>6</span>）以及其它平台认为应当终止服务的情况。<span></span>
                    &nbsp;
                </p>

                <p>
                    5.2.<span> </span>您同意，您与平台的合同关系终止后，平台仍享有下列权利<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>1</span>）继续保存您的用户信息及您使用平台服务期间的所有日志信息。<span></span>
                    &nbsp;
                </p>

                <p>
                    （<span>2</span>）您在使用平台服务期间存在违法行为或违反本协议和<span>/</span>或规则的行为的，平台仍可依据本协议向您主张权利。<span></span>
                    &nbsp;
                </p>
                <h4>
                    六、客户服务<span></span>
                    &nbsp;
                </h4>

                <p>
                    6.1.如果您对平台采取的措施有异议或在使用过程中有其他问题的，均可联系平台客户服务部门处理，我们会给予您必要的帮助。<span></span>
                    &nbsp;
                </p>
                <h4>
                    七、免责声明
                </h4>

                <p>
                    7.1.
                    客户明确同意使用一点社区帐号服务的风险由客户承担。综合平台明确表示不提供任何类型的担保，不论是明确的或隐含的。综合平台将尽力维护客户使用一点社区帐号服务
                    的合法权益，但不担保一点社区帐号服务一定能满足客户的要求，也不担保服务的及时性、安全性、真实性、稳定性、正确性。对客户使用该等服务中出现的信息（包括
                    但不限于客户发布的信息）删除或储存失败，一点社区亦不承担任何责任。
                </p>

                <p>
                    7.2.
                    客户理解并接受下载或通过相应产品服务取得的任何信息资料取决于客户自己，并自行承担系统受损、资料丢失以及其它任何风险。综合平台对客户在互联网上得到的任何商品购物服务、交易进程、招聘信息等，都不作担保。
                </p>

                <p>
                    7.3. 一点社区对直接、间接、偶然、特殊及继起的损害不负责任，这些损害来自：不正当使用一点社区帐号服务及 /
                    或应用服务，在网上购买商品或类似服务，在网上进行交易，非法使用服务或客户传送的信息有所变动。
                </p>

                <p>
                    7.4.
                    一点社区帐号对本项服务下涉及的境内外基础电信运营商的电信通信网络的故障、技术缺陷、覆盖范围限制、不可抗力、计算机病毒、黑客攻击、客户所在位置、客户关
                    机或其他非一点社区帐号技术能力范围内的事因等造成的服务中断、资料丢失、出现乱码、错误接收、无法接收、迟延接收不承担责任。
                </p>

                <p>
                    7.5. 综合平台保留判定客户的行为是否符合本服务条款要求的权利，如果客户违背了本服务条款的规定，综合平台有权中止或者终止相应一点社区帐号服务。
                </p>

                <p>
                    7.6.
                    转户规定：如果客户将手机号码、固定电话号码转让给他人，请客户提前自行删除一点社区帐号内资料（含邮件、通讯录、网盘资料等个人数据）。否则，受让该号码的客户将能够查看您的客户个人数据。综合平台不承担由此引发的客户数据丢失等责任及纠纷。
                </p>
                <h4>
                    八、隐私条款
                </h4>

                <p>
                    8.1尊重客户个人隐私是一点社区的一项基本政策。平台将采取合理的安全手段保护客户已存储的个人信息，在未得到客户许可之前，平台不会将客户的任
                    何个人信息提供给任何第三方（包括公司或个人），除非平台根据法律规定或政府强制要求公开个人资料，或因善意确信这样的作法符合下列任一项：
                </p>

                <p>
                    （1）符合法律公告或适用于平台服务的合法程序；
                </p>

                <p>
                    （2）保护平台的知识产权或其他重要权利；
                </p>

                <p>
                    （3）在紧急的情况下，竭力维护客户个人和社会大众的隐私安全。
                </p>
                <h4>
                    九、法律适用<span></span>
                    &nbsp;
                </h4>

                <p>
                    9.1.本协议之效力、解释、变更、执行与争议解决均适用中华人民共和国大陆地区法律，如无相关法律规定的，则应参照通用国际商业惯例和（或）行业惯例。<span></span>
                    &nbsp;
                </p>

                <p>
                    9.2.<span> </span>本规则所有条款的标题仅为阅读方便，本身并无实际涵义，不能作为本规则涵义解释的依据。<span></span>
                    &nbsp;
                </p>

                <p>
                    9.3.<span> </span>本规则条款无论因何种原因部分无效或不可执行，其余条款仍有效，对双方具有约束力。
                </p>

                <p>
                    <br/>
                </p>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-dismiss="modal">关闭</button>
            </div>
        </div>
        </div>
    </div>
</div>

</body>
</html>
<script>

    $("#AgreementInput").click(function () {

        if ($('#AgreementInput').is(':checked')) {
            $("#reg").removeAttr("disabled");
        } else {
            $('#reg').attr({"disabled": "disabled"});
        }
    });
    //回车提交
    $(".form").keyup(function (e) {
        if (e.keyCode === 13) {
            register();
            return false;
        }
    });
    //TODO 倒计时的处理
    $('#VerifyMessage').removeAttr("disabled");
    function getVerifyCode() {
        var target = "{:U('getVerifyCode')}";
        var mobile = $("#mobile").val();
        if (mobile == "") {
            $('#msg').addClass('alert alert-warning').html("手机号不能为空！");
            $("#mobile").focus();
            return false;
        }
        $.get(target, {"mobile": mobile}, function (data) {
            //TODO
            $('#VerifyMessage').attr({"disabled": "disabled"});
            if (data.status) {

                $('#msg').addClass('alert alert-success').html("发送成功！");
            } else {
                $('#msg').addClass('alert alert-warning').html("发送失败！错误原因:" + data.info);
                $('#VerifyMessage').removeAttr("disabled");
            }
        });
    }

    function register() {
        var username = $("#username").val();
        var mobile = $("#mobile").val();
        var password = $("#password").val();
        var repassword = $("#repassword").val();
        var email = $("#email").val();
        var verify_code = $('#verify_code').val();

        if (mobile == "") {
            $('#msg').addClass('alert alert-warning').html("手机号不能为空！");
            $("#mobile").focus();
            return false;
        }
        if (verify_code == "") {
            $('#msg').addClass('alert alert-warning').html("验证码不能为空！");
            $("#verify_code").focus();
            return false;
        }
        if (password == "") {
            $('#msg').addClass('alert alert-warning').html("密码不能为空！");
            $("#password").focus();
            return false;
        }

        if (password != repassword) {
            $('#msg').addClass('alert alert-warning').html("两次密码输入不一致！");
            $("#repassword").focus();
            return false;
        }

        password = $.md5(password);

        repassword = $.md5(repassword);

        $.ajax({
            type: "POST",
            url: '{:U("Public/register")}',
            dataType: "json",
            data: {
                "mobile": mobile,
                "password": password,
                "email": email,
                "repassword": repassword,
                "verify_code": verify_code,
                "username": username,
            },
            beforeSend: function () {
                $('#msg').addClass('alert alert-success').html("正在注册...");
            },
            success: function (json) {
                if (json.status == 1) {
                    $('#msg').addClass('alert alert-success').html("注册成功，正在跳转...");
                    alert('注册成功！');
                    window.location.href = json.url;
                } else {
                    $('#msg').addClass('alert alert-warning').html("注册失败！" + json.info);
                    return false;
                }
            }
        });
    }

</script>